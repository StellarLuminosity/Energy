{
  "stage_name": "kd_olmo2_32b_to_7b_nosft",
  "stage_id": "kd_olmo2_32b_to_7b_nosft",
  "config": {
    "experiment": {
      "seed": 42,
      "debug_mode": false,
      "debug_max_steps": 40,
      "name": "kd_olmo2_32b_to_7b_nosft",
      "description": "Logit KD from 32B to 7B with top-100 cached teacher logprobs"
    },
    "data": {
      "dataset_choice": "tulu",
      "dataset_name": "allenai/tulu-3-sft-mixture",
      "dataset_path": "/scratch/klambert/dataset/tulu-3-sft-mixture-preprocessed",
      "tokenizer_name": "allenai/OLMo-2-1124-7B-SFT",
      "max_sequence_length": 1024,
      "pad_token_id": 100277,
      "datasets": {
        "tulu": {
          "dataset_name": "allenai/tulu-3-sft-mixture",
          "dataset_path": "/scratch/klambert/dataset/tulu-3-sft-mixture-preprocessed"
        },
        "codeforces": {
          "dataset_name": "open-r1/codeforces-cots",
          "dataset_subset": "solutions",
          "dataset_path": "/scratch/klambert/dataset/open-r1-codeforces-preprocessed"
        },
        "math": {
          "dataset_name": "open-r1/OpenR1-Math-220k",
          "dataset_split": "train",
          "dataset_path": "/scratch/klambert/dataset/openr1-math-220k-preprocessed"
        }
      },
      "dataset_teacher_logprobs": "/scratch/klambert/dataset/logprob_cache/teacher_logprobs"
    },
    "synthetic_data": {
      "num_samples": 20000,
      "max_gen_examples": 7000
    },
    "training": {
      "token_budget": 10000000000,
      "batch_size": 4,
      "eval_batch_size": 1,
      "gradient_accumulation_steps": 16,
      "optimizer": "adafactor",
      "learning_rate": 5e-05,
      "max_grad_norm": 1.0,
      "num_warmup_steps": 100,
      "schedule_type": "cosine",
      "dtype": "bfloat16",
      "num_epochs": 2,
      "num_training_steps": 0,
      "save_steps": 200,
      "eval_steps": 100,
      "resume_from_checkpoint": false
    },
    "energy": {
      "enabled": true,
      "nvml_poll_interval_ms": 500,
      "track_cpu": true,
      "country_iso_code": "CAN",
      "offline_mode": true,
      "rapl_root": "/sys/class/powercap/intel-rapl",
      "total_energy_policy": "measured"
    },
    "wandb": {
      "enabled": true,
      "project": "distillation-energy-benchmark",
      "entity": null,
      "run_name": "kd_32b_to_7b_nosft",
      "log_interval": 10
    },
    "hardware": {
      "assert_gpu_name": null,
      "assert_gpu_count": null,
      "assert_cpu_brand": null
    },
    "benchmark": {
      "output_dir": "/scratch/klambert/model_log/olmo_benchmarks",
      "model": "/scratch/klambert/model_log/energy_experiments/kd_32b_to_13b/checkpoints/checkpoint_epoch0_step13200.pt",
      "model_type": "allenai/OLMo-2-1124-13B-SFT",
      "subfolder_name": "olmo_benchmark_13b_trained_adafactor",
      "tasks": [
        "core_9mcqa::olmes"
      ]
    },
    "output": {
      "run_dir": "/home/klambert/projects/aip-craffel/klambert/Energy/logs",
      "output_dir": "/scratch/klambert/model_log/energy_experiments/kd_32b_to_7b_nosft"
    },
    "pipeline": "kd",
    "model": {
      "teacher": "allenai/OLMo-2-0325-32B-SFT",
      "student": "allenai/OLMo-2-1124-7B-SFT",
      "student_vocab_size": 100352
    },
    "distillation": {
      "alpha": 0.5,
      "temperature": 1.0,
      "top_k_logits": 100,
      "logprob_cache_path": "/scratch/klambert/dataset/logprob_cache"
    }
  }
}
